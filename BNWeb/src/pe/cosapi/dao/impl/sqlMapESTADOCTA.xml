<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="sqlMapESTADOCTA">

	<select id="getEstadoConsulta" parameterClass="pe.cosapi.domain.impl.EstadoCtaImpl" resultClass="pe.cosapi.domain.impl.EstadoCtaImpl">
		SELECT 
			 B.FPROCESO,	B.NCUENTA,	   B.CODCLIENTE,
			 B.NOMBRE1CLIENTE, B.NOMBRE2CLIENTE, B.NOMBRECUENTA1,
			 B.NOMBRECUENTA2, B.CODGRUPO, B.DIR1DISTRIBUCION,
			 B.DIR2DISTRIBUCION, B.NOMBREGRUPO1, B.NOMBREGRUPO2,
			 A.CTRANSACCION, A.NSECUENCIA NSECUENCIA , B.NSECUENCIA  NSECUENCIAHEAD,
			 C.NSECUENCIA NSECUENCIARESUM, A.TREGISTRO,
			 A.CTRANSACCION , A.FPROCTRANSACCION,				   A.NDOCUMENTO,
			 A.SIMPORTE,				   A.CDEPTRANSACCION,			   A.CHKCERT,
			 A.SALDDIA,		   A.SIGSALDDIA,				   A.CODORIGTRAN,
			 A.SALDULTESTEMITIDO , A.FUTLESTEMITIDO,  A.NCOPIAESTADO,
			 A.SIGULTESTADO ,A.TSALDO,
			 C.NOPERACIONES,			   C.TOTCARGO,			   C.TOTABONO,
			 C.SALDCONTABFINAL,		   C.SIGNOSALDCONTABFINAL

			 FROM 
				BN_PSERVICIO.BNDETR_MOVIMIENTO A , BN_PSERVICIO.BNDETR_CABECERA B ,BN_PSERVICIO.BNDETR_RESUMEN C
			 WHERE 
					   B.NCUENTA = '00000295558'
				 	   AND SUBSTR(A.FPROCESO,0,6) = '200512'
				 	   AND A.FPROCESO 	= B.FPROCESO
				 	   AND A.NCUENTA 	= B.NCUENTA
				 	   AND C.NCUENTA 	= B.NCUENTA
				 	   AND C.FPROCESO 	= B.FPROCESO   
			ORDER BY A.nsecuencia;
	</select>

</sqlMap>